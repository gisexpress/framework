//////////////////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright © GISExpress 2015-2022. All Rights Reserved.
//  
//  GISExpress .NET API and Component Library
//  
//  The entire contents of this file is protected by local and International Copyright Laws.
//  Unauthorized reproduction, reverse-engineering, and distribution of all or any portion of
//  the code contained in this file is strictly prohibited and may result in severe civil and 
//  criminal penalties and will be prosecuted to the maximum extent possible under the law.
//  
//  RESTRICTIONS
//  
//  THIS SOURCE CODE AND ALL RESULTING INTERMEDIATE FILES ARE CONFIDENTIAL AND PROPRIETARY TRADE SECRETS OF GISExpress
//  THE REGISTERED DEVELOPER IS LICENSED TO DISTRIBUTE THE PRODUCT AND ALL ACCOMPANYING .NET COMPONENTS AS PART OF AN EXECUTABLE PROGRAM ONLY.
//  
//  THE SOURCE CODE CONTAINED WITHIN THIS FILE AND ALL RELATED FILES OR ANY PORTION OF ITS CONTENTS SHALL AT NO TIME BE
//  COPIED, TRANSFERRED, SOLD, DISTRIBUTED, OR OTHERWISE MADE AVAILABLE TO OTHER INDIVIDUALS WITHOUT EXPRESS WRITTEN CONSENT
//  AND PERMISSION FROM GISExpress
//  
//  CONSULT THE END USER LICENSE AGREEMENT FOR INFORMATION ON ADDITIONAL RESTRICTIONS.
//  
//  Warning: This content was generated by GISExpress tools.
//  Changes to this content may cause incorrect behavior and will be lost if the content is regenerated.
//
///////////////////////////////////////////////////////////////////////////////////////////////////

using System.Diagnostics;
using System.Geometries.Operation.Polygonize;

namespace System.Geometries.Diagnostics
{
    internal class GeometryTest : IUnitTest
    {
        public int Priority
        {
            get { return 1000; }
        }

        public void Run()
        {
            Parse();
            JsonParse();
            ValidateMeasurements();
            Intersects();
            Intersection();
            Union();
            Buffer();
            Poligonize();
        }

        void Parse()
        {
            Debug.Assert(Geometry.Read(Resources.WktPoint).GetHashCode() == 1081165266);
            Debug.Assert(Geometry.Read(Resources.WktLineString).GetHashCode() == 2092112048);
            Debug.Assert(Geometry.Read(Resources.WktPolygon).GetHashCode() == 686952684);
            Debug.Assert(Geometry.Read(Resources.WktPolygon2).GetHashCode() == -811775300);
            Debug.Assert(Geometry.Read(Resources.WktMultiPoint).GetHashCode() == 1464860951);
            Debug.Assert(Geometry.Read(Resources.WktMultiPoint2).GetHashCode() == 1464860951);
            Debug.Assert(Geometry.Read(Resources.WktMultiLineString).GetHashCode() == 53643950);
            Debug.Assert(Geometry.Read(Resources.WktMultiPolygon).GetHashCode() == -1806547570);
            Debug.Assert(Geometry.Read(Resources.WktMultiPolygon2).GetHashCode() == -1055904345);
            Debug.Assert(Geometry.Read(Resources.WktGeometryCollection).GetHashCode() == 1849605320);
        }

        void JsonParse()
        {
            //if (DeveloperEnvironment.MSFramework)
            //{
            //    Debug.Assert(JsonGeometryCollection.Parse(@"{ ""type"": ""Point"", ""coordinates"": [100.0, 0.0] }").ToGeometry().GetHashCode() == 410406933);
            //    Debug.Assert(JsonGeometryCollection.Parse(@"{ ""type"": ""GeometryCollection"", ""geometries"": [ { ""type"": ""Point"", ""coordinates"": [100.0, 0.0] }, { ""type"": ""LineString"", ""coordinates"": [ [101.0, 0.0], [102.0, 1.0] ] } ] }").ToGeometry().GetHashCode() == 1950049287);
            //    Debug.Assert(JsonGeometryCollection.Parse(@"{""type"":""MultiPolygon"",""coordinates"":[[[[33.112959633749,39.7490748762823],[33.1128625209796,39.7489662810232],[33.1127911340393,39.7488873787105],[33.1126964036309,39.7489223186974],[33.1127417818782,39.7490244222089],[33.1128679353639,39.7491425045586],[33.112959633749,39.7490748762823]]]]}").ToGeometry().GetHashCode() == -740268387);

            //    var r = JsonFeatureCollection.Parse(@"{""features"":[{""type"":""Feature"",""geometry"":{""type"":""MultiPolygon"",""coordinates"":[[[[33.112959633749,39.7490748762823],[33.1128625209796,39.7489662810232],[33.1127911340393,39.7488873787105],[33.1126964036309,39.7489223186974],[33.1127417818782,39.7490244222089],[33.1128679353639,39.7491425045586],[33.112959633749,39.7490748762823]]]]},""properties"":{""ParselNo"":""3"",""SayfaNo"":""3"",""Alan"":""304,00"",""Mevkii"":""Köyiçi"",""Nitelik"":""Kerpiç ahır ve arsası"",""CiltNo"":""1"",""Ada"":""0"",""Il"":""Ankara"",""Ilce"":""Çankaya"",""Pafta"":""1"",""Mahalle"":""Akarlar""}}],""type"":""FeatureCollection"",""crs"":{""type"":""name"",""properties"":{""name"":""EPSG:4326""}}}");

            //    Debug.Assert(r.Features.Count == 1);
            //    Debug.Assert(r.Features[0].Properties.Count == 11);
            //    Debug.Assert(r.Features[0].Geometry.ToGeometry().GetHashCode() == -740268387);
            //    Debug.Assert(r.CoordinateSystem.Properties[r.CoordinateSystem.Type].Equals("EPSG:4326"));
            //}
        }

        void ValidateMeasurements()
        {
            IGeometry g = Geometry.Read("POLYGON ((421053 4538353, 421065 4538366, 421080 4538382, 421083 4538382, 421105 4538361, 421130 4538341, 421131 4538335, 421125 4538329, 421067 4538268, 421092 4538246, 421059 4538209, 421040 4538225, 421020 4538247, 421007 4538260, 420988 4538278, 420988 4538282, 421010 4538306, 421032 4538331, 421053 4538353))");

            Debug.Assert(g.GetArea().Equals(11376.0));
            Debug.Assert(g.GetLength().Equals(486.07531925056344));
            Debug.Assert(g.GetCentroid().IsEquivalent(421059.354210619, 4538298.19485466));

            g.Coordinates.RemoveAt(1);
            Debug.Assert(g.GetArea().Equals(11374.5));
            Debug.Assert(g.GetLength().Equals(486.07502655046591));
            Debug.Assert(g.GetCentroid().IsEquivalent(421059.353334212, 4538298.18578106));

            g.Coordinates.RemoveAt(0);
            Debug.Assert(g.GetArea().Equals(11382.0));
            Debug.Assert(g.GetLength().Equals(486.07369356622945));
            Debug.Assert(g.GetCentroid().IsEquivalent(421059.350465648, 4538298.22343759));

            g.Coordinates.RemoveAt(g.NumPoints() - 2);
            Debug.Assert(g.GetArea().Equals(11343.0));
            Debug.Assert(g.GetLength().Equals(486.06106760067939));
            Debug.Assert(g.GetCentroid().IsEquivalent(421059.414705104, 4538298.08094566));

            g.Coordinates.Get(0).SetValues(421053, 4538278);
            Debug.Assert(g.GetArea().Equals(8573.0));
            Debug.Assert(g.GetLength().Equals(539.289576240512));
            Debug.Assert(g.GetCentroid().IsEquivalent(421062.767798126, 4538289.89153933));

            g.Coordinates.Get(6).SetValues(421182, 4538290);
            Debug.Assert(g.GetArea().Equals(12982.5));
            Debug.Assert(g.GetLength().Equals(591.06050747401639));
            Debug.Assert(g.GetCentroid().IsEquivalent(421082.486886193, 4538288.57120483));

            g.Coordinates.IsClosed = false;

            Debug.Assert(g.GetArea().Equals(12982.5));
            Debug.Assert(g.GetLength().Equals(591.06050747401639));
            Debug.Assert(g.GetCentroid().IsEquivalent(421082.486886193, 4538288.57120483));

            g.Coordinates.IsClosed = true;

            Debug.Assert(g.GetArea().Equals(12982.5));
            Debug.Assert(g.GetLength().Equals(591.06050747401639));
            Debug.Assert(g.GetCentroid().IsEquivalent(421082.486886193, 4538288.57120483));
        }

        void Intersects()
        {
            IGeometry g1, g2;

            g1 = GeometryFactory.Read("LINESTRING (-40 35, -25 35)");
            g2 = GeometryFactory.Read("LINESTRING (-34.88843741520575 35, -32.520421735916145 35)");

            Debug.Assert(g1.IsIntersects(g2));

            g1 = GeometryFactory.Read("LINESTRING (-68.025078941527056 -32.758619377411975, 57.6802482188601 33.385580200746851)");
            g2 = GeometryFactory.Read("LINESTRING (-44.199339314143629 -20.221883563501976, 13.013414885654868 9.8825831102074631)");

            Debug.Assert(g1.IsIntersects(g2));
            //Debug.Assert(g1.Intersection(g2).IsEquivalent(g2));
        }

        void Intersection()
        {
            ValidateIntersection(
                "POLYGON ((421053.3453946530000000 4538353.9576003500000000, 421065.8854067580000000 4538366.3159749600000000, 421080.8458892840000000 4538382.7313681800000000, 421083.6151184930000000 4538382.7998768200000000, 421105.3270000000000000 4538361.4740000000000000, 421130.7522060240000000 4538341.3225657000000000, 421131.0849767980000000 4538335.9803720700000000, 421125.2143873630000000 4538329.9997629500000000, 421067.4520843700000000 4538268.4626583700000000, 421092.6763612130000000 4538246.2857143600000000, 421059.5098884450000000 4538209.8687565300000000, 421040.1958137110000000 4538225.8372419600000000, 421020.0310000000000000 4538247.4050000000000000, 421007.7144971060000000 4538260.3783296900000000, 420988.8374449530000000 4538278.5713750500000000, 420988.6991499080000000 4538282.8744008000000000, 421010.5683954690000000 4538306.9021948000000000, 421032.2027307260000000 4538331.2330875700000000, 421053.3453946530000000 4538353.9576003500000000))",
                "POLYGON ((421003.4630664950000000 4538299.0955523400000000, 421010.5683954690000000 4538306.9021948000000000, 421020.7045213960000000 4538318.3017127500000000, 421044.5548108540000000 4538292.4714000100000000, 421027.3041324670000000 4538277.2508368000000000, 421003.4630664950000000 4538299.0955523400000000))",
                "POLYGON ((421027.304132467 4538277.2508368, 421044.554810854 4538292.47140001, 421020.70452139754 4538318.3017127486, 421010.568395469 4538306.9021948, 421003.463066495 4538299.09555234, 421027.304132467 4538277.2508368))",
                820.63352855341509);

            ValidateIntersection(
                "POLYGON ((420991.6578187160000000 4537203.8417257500000000, 420975.7904356270000000 4537210.4338439000000000, 420974.0370705430000000 4537211.0934976000000000, 420980.4705707130000000 4537226.0102915300000000, 420984.9258597070000000 4537223.9519219200000000, 420990.1649162770000000 4537221.5314470900000000, 420993.7558677990000000 4537224.1993406900000000, 421034.4245436250000000 4537315.1051169600000000, 421035.9995344040000000 4537319.8370112600000000, 421042.7324168800000000 4537317.4579419200000000, 421040.9614273020000000 4537312.1980595500000000, 421011.4806619110000000 4537245.7246746700000000, 421000.8077379630000000 4537220.8462791800000000, 421003.0666862500000000 4537217.2803020600000000, 421015.1824642490000000 4537211.6271935400000000, 421009.3854999860000000 4537197.4135342900000000, 421001.5176411840000000 4537200.2556196100000000, 420991.6578187160000000 4537203.8417257500000000))",
                "POLYGON ((420980.3530705560000000 4537226.0614976100000000, 420990.1342356350000000 4537221.5613920200000000, 420993.7251731360000000 4537224.2292162000000000, 421034.3942795570000000 4537315.1338276600000000, 421035.9692975710000000 4537319.8656699400000000, 421042.7020823620000000 4537317.4865228600000000, 421040.9310625980000000 4537312.2266983800000000, 421011.4499816760000000 4537245.7541550700000000, 421000.7769293050000000 4537220.8760750500000000, 421003.0358159380000000 4537217.3100886600000000, 421015.1513998720000000 4537211.6568416700000000, 421009.3543560310000000 4537197.4433585500000000, 421001.4866152450000000 4537200.2855399600000000, 420991.6269414230000000 4537203.8717659500000000, 420975.7904356270000000 4537210.4338439000000000, 420974.0211413780000000 4537211.1688987400000000, 420980.3530705560000000 4537226.0614976100000000))",
                "POLYGON ((421009.354356031 4537197.44335855, 421015.146207448 4537211.64411062, 421003.06668625 4537217.28030206, 421003.052853209 4537217.30213891, 421003.035815938 4537217.31008866, 421000.776929305 4537220.87607505, 421011.449981676 4537245.75415507, 421040.931062598 4537312.22669838, 421042.696707506 4537317.47055986, 421035.999534404 4537319.83701126, 421034.424543625 4537315.10511696, 420993.755867799 4537224.19934069, 420990.164916277 4537221.53144709, 420984.925859707 4537223.95192192, 420981.951103444 4537225.32627674, 420980.469543885 4537226.00791071, 420974.062228465 4537211.15182907, 420975.790435627 4537210.4338439, 420991.626941423 4537203.87176595, 421001.486615245 4537200.28553996, 421009.354356031 4537197.44335855))",
                1405.4236175513943);


            ValidateIntersection(
                "POLYGON ((421214.0817830590000000 4538246.9481462300000000, 421236.9516050520000000 4538263.5807440400000000, 421248.9062847300000000 4538271.3772742600000000, 421261.3807330890000000 4538274.4958863500000000, 421270.9121448230000000 4538276.2528113900000000, 421285.8098611270000000 4538277.6144984400000000, 421307.6401457560000000 4538278.1342671200000000, 421320.6343627970000000 4538278.1342671200000000, 421340.9053413810000000 4538282.2924165800000000, 421360.1367826020000000 4538279.6935731700000000, 421373.6507683250000000 4538275.5354237200000000, 421404.8368892240000000 4538269.2981995400000000, 421426.6671738530000000 4538263.5807440400000000, 421431.3450919880000000 4538201.2085022400000000, 421400.6787397710000000 4538145.0734846200000000, 421256.1830462730000000 4538157.5479329800000000, 421214.6015517410000000 4538178.8584489300000000, 421214.0817830590000000 4538246.9481462300000000))",
                "POLYGON ((421236.9516050520000000 4538263.5807440400000000, 421262.3591655880000000 4538198.9790282800000000, 421310.1934586640000000 4538208.3787802000000000, 421343.1970320520000000 4538220.4940160000000000, 421338.3927144070000000 4538255.1686563900000000, 421330.7907126310000000 4538280.2176209400000000, 421320.6343627970000000 4538278.1342671200000000, 421307.6401457560000000 4538278.1342671200000000, 421285.8098611270000000 4538277.6144984400000000, 421261.3807330890000000 4538274.4958863500000000, 421248.9062847300000000 4538271.3772742600000000, 421236.9516050520000000 4538263.5807440400000000))",
                "POLYGON ((421262.359165588 4538198.97902828, 421310.193458664 4538208.3787802, 421343.197032052 4538220.494016, 421338.392714407 4538255.16865639, 421330.790712632 4538280.21762094, 421320.634362797 4538278.13426712, 421307.640145756 4538278.13426712, 421285.809861127 4538277.61449844, 421261.380733089 4538274.49588635, 421248.90628473 4538271.37727426, 421236.951605052 4538263.58074404, 421262.359165588 4538198.97902828))",
                6343.1287369802594);

            ValidateIntersection(
                "POLYGON ((421724.4386811780000000 4538418.7912272400000000, 421881.7963626400000000 4538467.2918824900000000, 422052.0875521670000000 4538415.5578502300000000, 422160.9445783840000000 4538316.4009550600000000, 422148.0110703190000000 4538268.9780921500000000, 422121.0662618490000000 4538201.0771748100000000, 422076.8767759590000000 4538133.1762574700000000, 421791.2618061820000000 4538181.6769127100000000, 421697.4938727080000000 4538253.8889994100000000, 421724.4386811780000000 4538418.7912272400000000))",
                "POLYGON ((421958.3196186930000000 4538349.8125175600000000, 422105.2009160980000000 4538367.1773603100000000, 422160.9445783840000000 4538316.4009550600000000, 422148.0110703190000000 4538268.9780921500000000, 422076.8767759590000000 4538133.1762574700000000, 421958.9482677870000000 4538153.2018531900000000, 421958.3196186930000000 4538349.8125175600000000))",
                "POLYGON ((422076.876775959 4538133.17625747, 422148.011070319 4538268.97809215, 422160.944578384 4538316.40095506, 422105.200916098 4538367.17736031, 421958.319618693 4538349.81251756, 421958.948267787 4538153.2018532, 422076.876775959 4538133.17625747))",
                36575.614420428872);

            ValidateIntersection(
                "POLYGON ((421036.2922886700000000 4537913.5954517300000000, 421406.9148957930000000 4537967.6057814100000000, 421682.5538196830000000 4537917.3203020500000000, 421794.2993293690000000 4537759.0141633300000000, 421758.9132513020000000 4537662.1680549400000000, 421449.7506745060000000 4537650.9935039700000000, 421190.8735770680000000 4537639.8189530000000000, 421103.3395944810000000 4537643.5438033200000000, 421040.0171389930000000 4537645.4062284800000000, 421012.0807615720000000 4537649.1310788100000000, 421000.9062106030000000 4537813.0244930100000000, 421036.2922886700000000 4537913.5954517300000000))",
                "POLYGON ((421017.5468756730000000 4537860.3190147900000000, 421180.5580624800000000 4537806.5438555400000000, 421241.3709982630000000 4537755.0867560300000000, 421252.2786910260000000 4537642.4695334600000000, 421190.8735770680000000 4537639.8189530000000000, 421012.0807615720000000 4537649.1310788100000000, 421000.9062106030000000 4537813.0244930100000000, 421017.5468756730000000 4537860.3190147900000000))",
                "POLYGON ((421190.873577068 4537639.818953, 421252.278691026 4537642.46953346, 421241.370998263 4537755.08675603, 421180.55806248 4537806.54385554, 421017.546875673 4537860.31901479, 421000.906210603 4537813.02449301, 421012.080761572 4537649.13107881, 421190.873577068 4537639.818953))",
                42120.646249633282);

            ValidateIntersection(
                "POLYGON ((422065.0464223710000000 4537927.0080564300000000, 422603.2872940330000000 4537973.5686854700000000, 422728.0697798510000000 4537807.8128461000000000, 422668.4721746840000000 4537506.0999699400000000, 422286.6750165850000000 4537487.4757183300000000, 422124.6440275370000000 4537584.3218267300000000, 422001.7239668810000000 4537725.8661390000000000, 422003.5863920420000000 4537813.4001215800000000, 422014.7609430110000000 4537859.9607506200000000, 422035.2476197870000000 4537893.4844035300000000, 422065.0464223710000000 4537927.0080564300000000))",
                "POLYGON ((422002.3989906610000000 4537757.5922566700000000, 422158.1676804440000000 4537748.2152409300000000, 422234.5271120640000000 4537826.4370977200000000, 422178.6543572200000000 4537895.3468286900000000, 422152.4099788700000000 4537934.5654575200000000, 422065.0464223710000000 4537927.0080564300000000, 422014.7609430110000000 4537859.9607506200000000, 422003.5863920420000000 4537813.4001215800000000, 422002.3989906610000000 4537757.5922566700000000))",
                "POLYGON ((422158.167680444 4537748.21524093, 422234.527112064 4537826.43709772, 422178.65435722 4537895.34682869, 422152.409978875 4537934.56545751, 422065.046422371 4537927.00805643, 422014.760943011 4537859.96075062, 422003.586392042 4537813.40012158, 422002.398990661 4537757.59225667, 422158.167680444 4537748.21524093))",
                31242.611928772181);

            ValidateIntersection(
                "POLYGON ((425599.80185027327 4273453.5117512355, 425598.06042152824 4273462.9396908153, 425570.347505057 4273568.94307649, 425561.9663421397 4273593.5102716908, 425578.09005458141 4273587.7413538136, 425585.240861689 4273585.1411123332, 425593.84183711954 4273581.2907419894, 425621.19494343124 4273568.3894916782, 425640.39711956016 4273560.0386919826, 425669.20038552047 4273547.2374620438, 425685.15219273797 4273540.3868072862, 425701.40402765764 4273534.3862484209, 425709.54525080911 4273532.3339175992, 425710.5590296025 4273521.110742894, 425713.84160981933 4273505.3259026594, 425720.0929632702 4273480.0798190506, 425722.1204548016 4273467.9153517913, 425723.39973239112 4273456.0405102056, 425722.43739480432 4273434.5562955262, 425720.80907063535 4273431.2343624169, 425639.21146914776 4273445.7359241592, 425632.90210477193 4273447.5520643555, 425599.80185027327 4273453.5117512355))",
                "POLYGON ((428146.08612060547 4273652.4072875977, 428159.55767822266 4273628.8320922852, 428242.51110839844 4273714.4000854492, 428301.828125 4273556.7869262695, 428348.76568603516 4273421.18951416, 428362.47387695312 4273381.67767334, 428373.90887451172 4273344.36328125, 428375.36352539062 4273344.5249023438, 428440.48272705078 4273351.7603149414, 428443.51611328125 4273352.0762939453, 428465.24871826172 4273354.3400878906, 428433.56408691406 4273262.3037109375, 428486.17230224609 4273230.419921875, 428543.92071533203 4273167.57611084, 428588.08111572266 4273113.22467041, 428650.92510986328 4273046.9838867188, 428681.72052001953 4272979.6898803711, 428710.67327880859 4272927.1253051758, 428756.36108398438 4272862.4938964844, 428766.421875 4272848.2614746094, 428802.08990478516 4272780.32232666, 428844.55212402344 4272719.1768798828, 428876.82330322266 4272678.4133300781, 428888.71252441406 4272659.7301025391, 428946.46087646484 4272556.1226806641, 428997.41552734375 4272452.5153198242, 429034.78210449219 4272377.7821044922, 429070.45031738281 4272292.8580932617, 429092.53051757812 4272202.8385009766, 429107.81689453125 4272156.9794921875, 429146.88208007812 4272063.5629272461, 429206.32891845703 4271942.970703125, 429250.48950195312 4271878.4282836914, 429309.93627929688 4271818.9815063477, 429374.47869873047 4271747.645324707, 429440.71948242188 4271647.4348754883, 429454.03552246094 4271628.2005004883, 429448.03332519531 4271624.0552978516, 429421.046875 4271610.5620727539, 429365.91650390625 4271627.2681274414, 429338.49090576172 4271635.578918457, 429283.45330810547 4271633.0772705078, 429228.41589355469 4271593.0501098633, 429123.3447265625 4271593.0501098633, 429060.80212402344 4271600.5551147461, 429020.77490234375 4271625.5720825195, 428973.24267578125 4271628.0739135742, 428918.20532226562 4271620.5687255859, 428860.66607666016 4271575.5380859375, 428825.64251708984 4271550.5211181641, 428768.10327148438 4271523.0025024414, 428716.28631591797 4271499.9727172852, 428717.39611816406 4271494.2647094727, 428712.30150159053 4271477.1421074132, 428719.72392229346 4271454.0901672561, 428722.95554703276 4271441.789583235, 428728.82830488251 4271425.6710591689, 428729.82795163768 4271418.5072603486, 428736.23697592603 4271401.7663886147, 428741.79340087844 4271382.2486453168, 428743.95747155289 4271365.3071159134, 428744.26938365586 4271335.3384631788, 428744.56628549244 4271317.336966862, 428745.61490156886 4271305.0404933179, 428748.42011696228 4271286.72348278, 428749.79623119062 4271276.7564066825, 428751.86894268316 4271262.6054243147, 428754.29900530638 4271248.0256261909, 428758.37295723904 4271219.9380700188, 428761.16047659877 4271188.4914308535, 428764.43436108419 4271137.8999071354, 428764.87249444093 4271122.360918534, 428769.28340483014 4271078.3615482869, 428769.75730298331 4271069.2638289947, 428772.59036713181 4271027.0655400138, 428773.79806958232 4271001.7860955214, 428774.07918537187 4270998.7324540261, 428774.91392188362 4270949.3783943076, 428774.20429308392 4270913.9167703344, 428772.12210762821 4270865.9871186316, 428771.83837234369 4270855.2340846788, 428773.31815067341 4270844.5301155718, 428775.05063402758 4270835.5531873424, 428780.10090925172 4270790.3453838136, 428784.68675361096 4270766.1959612705, 428792.7347714965 4270731.2077498129, 428794.45864356781 4270722.909377561, 428794.57899858983 4270709.1188282659, 428796.02223200438 4270703.466315561, 428801.5946755202 4270688.0321601518, 428810.36620087165 4270669.5948259905, 428818.76735924167 4270650.3978593359, 428836.58825456293 4270604.0864202967, 428851.21901530965 4270562.0651046764, 428866.56714802969 4270513.8103053737, 428867.5943284338 4270509.5549635589, 428877.8393834923 4270474.2391769653, 428882.31435982574 4270455.6067245565, 428882.52774397377 4270437.3723972337, 428883.59413687291 4270428.3618732383, 428886.42608953081 4270412.8070481308, 428888.81939559348 4270394.5590869477, 428895.2175484972 4270372.3260430656, 428901.4024107639 4270353.7718536044, 428903.65930425137 4270330.1468478134, 428874.83280876116 4270325.6089883177, 428858.794921875 4270306.7072753906, 428855.76831054688 4270277.1981201172, 428848.12487792969 4270270.2581176758, 428849.81909179688 4270267.1301269531, 428823.48388671875 4270247.8850708008, 428816.17327880859 4270242.5429077148, 428803.46771240234 4270238.59967041, 428743.62408447266 4270220.0275268555, 428658.56628417969 4270205.0172729492, 428543.48809814453 4270167.4918823242, 428523.04028320312 4270151.661315918, 428465.93548583984 4270107.45111084, 428375.87432861328 4270062.4202880859, 428328.34210205078 4270014.8881225586, 428302.42388916016 4269988.1339111328, 428109.04168701172 4270153.8900756836, 428082.87170410156 4270165.7086791992, 427803.86291503906 4270291.7127075195, 427637.96447753906 4270415.5523071289, 427594.54370117188 4270352.5922851562, 427481.31170654297 4270246.1541137695, 427469.34069824219 4270204.2554931641, 427455.56048583984 4270214.8430786133, 427370.70611572266 4270311.4014892578, 427295.23168945312 4270590.3283081055, 427273.96008300781 4270805.7033081055, 427270.84490966797 4270837.2432861328, 427229.67651367188 4270915.7614746094, 427192.20611572266 4270990.7020874023, 427173.81628417969 4271026.3671264648, 427173.81628417969 4271108.803894043, 427223.03869628906 4271164.5892944336, 427446.18011474609 4271236.7821044922, 427532.73272705078 4271268.838684082, 427545.30712890625 4271273.3474731445, 427533.38427734375 4271282.0603027344, 427448.46008300781 4271344.9041137695, 427341.45568847656 4271423.0343017578, 427203.87872314453 4271516.4509277344, 427118.95452880859 4271572.5006713867, 427001.75927734375 4271638.7415161133, 426932.12152099609 4271681.2034912109, 426861.12487792969 4271725.364074707, 426781.29632568359 4271772.9215087891, 426771.8046875 4271778.4774780273, 426761.39752197266 4271774.2257080078, 426698.19534305634 4271819.56442287, 426633.39168628328 4271866.3096479233, 426569.58534121758 4271911.92266905, 426519.06076689286 4271939.8900344856, 426466.69577513961 4271956.32854418, 426344.69461186137 4271973.5141007574, 426292.73388752353 4271988.2843595315, 426245.7064480969 4272008.8200883577, 426186.14807128906 4272029.3922729492, 426113.53945787228 4272061.1175345192, 426046.87249755859 4272104.1254882812, 425980.63171386719 4272148.2858886719, 425930.01690673828 4272172.0646972656, 425867.17309570312 4272209.4312744141, 425780.55047607422 4272253.5916748047, 425719.49481093558 4272288.3595882328, 425627.68707275391 4272330.0234985352, 425518.6198372232 4272364.0185145764, 425426.65120640915 4272396.8189186594, 425405.93408203125 4272403.5803222656, 425277.79852294922 4272383.64831543, 425193.78423183842 4272356.2086699763, 425184.84125954 4272353.3222503988, 425165.88348388672 4272348.8637084961, 425152.27227783203 4272320.12890625, 425157.43212890625 4272272.3997192383, 425157.89190673828 4272257.3010864258, 425157.95727539062 4272257.2443237305, 425157.896484375 4272257.1528930664, 425138.23547363281 4272217.8314819336, 425138.23547363281 4272183.046875, 425120.08728027344 4272116.5029296875, 425101.93872070312 4272034.8350830078, 425129.16149902344 4271972.828125, 425130.09527587891 4271942.00970459, 425130.67388916016 4271922.919921875, 425129.52490234375 4271912.0056762695, 425127.27349853516 4271890.6160888672, 425120.96472837805 4271868.3351658, 425045.925386737 4271955.4054902373, 424956.44306521915 4272059.67541768, 424871.87722366175 4272161.2318597529, 424811.20055353205 4272243.5737071373, 424676.82099532796 4272403.3109079534, 424643.37346572278 4272441.6526144668, 424609.26102766348 4272476.0713905152, 424504.85580722825 4272610.0047802823, 424388.93113719684 4272748.4418824492, 424252.15692138672 4272963.72467041, 424159.30651855469 4273058.83972168, 424068.72088623047 4273124.5142822266, 423984.92907714844 4273187.9243164062, 423946.78369140625 4273218.9174804688, 423946.51849365234 4273219.1328735352, 423957.71868896484 4273233.8530883789, 424023.09252929688 4273319.7728881836, 423952.97290039062 4273481.0479125977, 423942.46868896484 4273505.2077026367, 423922.76287274063 4273550.5310474951, 423940.12258851813 4273565.0129836574, 423968.27000240842 4273578.002023194, 423983.01620381983 4273585.8060330339, 423997.49890874833 4273598.867291471, 424020.84442670329 4273618.6511918753, 424029.96559151058 4273627.5651720464, 424042.81817134138 4273635.54632393, 424056.81091658352 4273641.5581283784, 424089.46066635835 4273653.8927179854, 424102.72789913253 4273653.7891529733, 424112.26370156766 4273657.00237201, 424120.14108866878 4273661.97763466, 424138.69442963251 4273670.3734241724, 424179.94709828746 4273690.7927886145, 424195.18362856045 4273699.6031578267, 424206.4814772692 4273704.0601911955, 424210.52037989924 4273706.1278265556, 424218.76917557133 4273712.5971467784, 424225.8603936978 4273717.3437539134, 424241.015025896 4273725.493068438, 424268.779451446 4273741.1054312754, 424274.26944615325 4273741.7631226666, 424295.5431460907 4273748.91169545, 424330.08433683444 4273757.089728266, 424345.52336652495 4273761.5394139551, 424354.77135473693 4273764.163020906, 424368.97128513205 4273767.3769578626, 424401.69998734869 4273775.6741372161, 424426.9188049676 4273780.8230112735, 424437.67533006344 4273783.9057487361, 424452.56393747334 4273787.7755770031, 424461.680756104 4273789.1857923754, 424472.86361820897 4273790.628815365, 424487.69975286315 4273792.7176892012, 424504.26183357532 4273797.127824638, 424531.30996003177 4273805.1640513167, 424541.20801008964 4273807.5161303906, 424552.968078703 4273808.88821498, 424571.98020072986 4273809.3783403495, 424593.18595376168 4273808.2729455531, 424617.35452150804 4273805.9486092683, 424640.58068198309 4273804.7727507446, 424657.14280361938 4273802.812844242, 424674.31919820426 4273802.5344565529, 424679.89872724121 4273801.9693066115, 424682.39401767636 4273801.2160985339, 424707.93960231717 4273799.4955763454, 424752.01569140912 4273792.0836723577, 424837.61977201316 4273780.9118844932, 424822.83752441406 4273774.9719238281, 424829.77252197266 4273770.862487793, 424853.37951660156 4273764.4821166992, 424866.7783203125 4273757.463684082, 424888.47113037109 4273741.5131225586, 424914.63031005859 4273721.7341308594, 424926.54748535156 4273717.0394897461, 425008.06707763672 4273687.5017089844, 425038.40808105469 4273677.0720825195, 425113.69567871094 4273663.6735229492, 425213.22827148438 4273657.29309082, 425301.27648925781 4273647.7227172852, 425335.09191894531 4273643.8944702148, 425379.75408935547 4273638.7902832031, 425426.96807861328 4273629.219909668, 425462.69787597656 4273619.6494750977, 425491.51514497 4273610.5461355895, 425497.58103581751 4273606.3928982615, 425526.53426053323 4273602.592664198, 425545.136344634 4273598.2423028313, 425552.98722526868 4273596.2421321766, 425561.73820957087 4273593.5918954518, 425578.09005458141 4273587.7413538136, 425585.240861689 4273585.1411123332, 425593.84183711954 4273581.2907419894, 425621.19494343124 4273568.3894916782, 425636.94715960533 4273564.1356666423, 425660.991685604 4273554.1638931055, 425745.98309326172 4273531.6015014648, 425810.42407226562 4273520.7548828125, 425821.0625 4273520.4013061523, 425831.79931640625 4273520.0444946289, 425836.01611328125 4273519.904296875, 425869.83172607422 4273514.1619262695, 425906.19927978516 4273505.2294921875, 425939.37689208984 4273499.4873046875, 425979.97479031427 4273481.8693338279, 425985.31027715636 4273481.0574469874, 425990.2978012829 4273479.704277169, 426002.47664958291 4273474.7941657985, 426009.35866401572 4273472.2424579319, 426013.61159632338 4273470.348002647, 426020.45822358265 4273464.5017334595, 426059.96447753906 4273446.5308837891, 426076.80627441406 4273436.6798706055, 426116.34291848348 4273413.5548483673, 426116.08836924494 4273411.2881203862, 426163.59128153912 4273380.6207861146, 426177.22271737235 4273371.9156855308, 426185.11815526884 4273366.5171699561, 426202.39365326863 4273353.1558293486, 426211.84605590673 4273345.2905325582, 426248.95652258146 4273316.5808418095, 426267.205078125 4273305.6696777344, 426268.60028076172 4273304.8883056641, 426280.72271728516 4273318.9249267578, 426281.69427490234 4273319.7056884766, 426316.45251464844 4273347.6362915039, 426420.45129394531 4273422.2858886719, 426475.95989990234 4273435.0465087891, 426690.02887559828 4273497.1757466728, 426692.71811140369 4273492.413026196, 426771.05389700766 4273517.49875311, 426864.88432523934 4273547.5463805245, 426918.66859238932 4273564.7698937319, 426927.92407226562 4273571.0264892578, 426994.91711425781 4273600.2164916992, 427047.55450439453 4273623.18548584, 427050.04547119141 4273623.9581298828, 427077.92309570312 4273632.6052856445, 427151.29650878906 4273657.4885253906, 427209.9951171875 4273679.1815185547, 427293.57708740234 4273700.8745117188, 427354.59368896484 4273715.5637207031, 427362.48413085938 4273717.4633178711, 427472.86328125 4273757.0211181641, 427574.31011962891 4273787.646484375, 427627.90447998047 4273804.2352905273, 427709.57232666016 4273830.3944702148, 427779.11767578125 4273857.1918945312, 427884.03649902344 4273895.1143188477, 427885.03051757812 4273895.4736938477, 427922.67431640625 4273908.2343139648, 427937.76251220703 4273916.3043212891, 427960.91107177734 4273893.4251098633, 427978.13787841797 4273873.2373046875, 428011.51489257812 4273828.2860717773, 428057.27349853516 4273772.8375244141, 428099.53308105469 4273720.3494873047, 428136.94750976562 4273668.3999023438, 428146.08612060547 4273652.4072875977))",
                "POLYGON ((425720.809070635 4273431.23436242, 425722.437394804 4273434.55629553, 425723.399732391 4273456.04051021, 425722.120454802 4273467.91535179, 425720.09296327 4273480.07981905, 425713.841609819 4273505.32590266, 425710.559029602 4273521.11074289, 425709.545250809 4273532.3339176, 425701.404027658 4273534.38624842, 425685.152192738 4273540.38680729, 425669.20038552 4273547.23746204, 425640.39711956 4273560.03869198, 425621.194943431 4273568.38949168, 425593.84183712 4273581.29074199, 425585.240861689 4273585.14111233, 425578.090054581 4273587.74135381, 425561.96634214 4273593.51027169, 425570.347505057 4273568.94307649, 425598.060421528 4273462.93969082, 425599.801850273 4273453.51175124, 425632.902104772 4273447.55206436, 425639.211469148 4273445.73592416, 425720.809070635 4273431.23436242))",
                15227.390568987932);

            //ValidateIntersection(
            //    "POLYGON ((428621.982791055 4270285.44356732, 428624.488683231 4270287.13256622, 428762.819684007 4270307.97591107, 428903.659304251 4270330.14684781, 428904.039262379 4270310.83238087, 428902.982643954 4270304.05212635, 428902.378397843 4270275.99086558, 428900.140766548 4270242.5271048, 428900.34289077 4270225.49052713, 428902.632506143 4270207.64590379, 428910.265890262 4270179.57558952, 428917.836525892 4270153.63390003, 428924.432786339 4270123.9493343, 428930.202724562 4270103.03152313, 428934.224251629 4270082.93413921, 428935.949108221 4270075.56180476, 428937.331038635 4270067.26577004, 428938.028166355 4270060.86129162, 428946.363971381 4270003.52089466, 428948.695181593 4269960.66521116, 428896.50906021 4269960.8528951, 428744.114185944 4269958.68257162, 428666.472518587 4269958.45655431, 428644.767282742 4269973.23999567, 428790.61794536 4270190.29799179, 428621.982791055 4270285.44356732))",
            //    "POLYGON ((428146.086120605 4273652.4072876, 428159.557678223 4273628.83209229, 428242.511108398 4273714.40008545, 428301.828125 4273556.78692627, 428348.765686035 4273421.18951416, 428362.473876953 4273381.67767334, 428373.908874512 4273344.36328125, 428375.363525391 4273344.52490234, 428440.482727051 4273351.76031494, 428443.516113281 4273352.07629395, 428465.248718262 4273354.34008789, 428433.564086914 4273262.30371094, 428486.172302246 4273230.41992188, 428543.920715332 4273167.57611084, 428588.081115723 4273113.22467041, 428650.925109863 4273046.98388672, 428681.72052002 4272979.68988037, 428710.673278809 4272927.12530518, 428756.361083984 4272862.49389648, 428766.421875 4272848.26147461, 428802.089904785 4272780.32232666, 428844.552124023 4272719.17687988, 428876.823303223 4272678.41333008, 428888.712524414 4272659.73010254, 428946.460876465 4272556.12268066, 428997.415527344 4272452.51531982, 429034.782104492 4272377.78210449, 429070.450317383 4272292.85809326, 429092.530517578 4272202.83850098, 429107.816894531 4272156.97949219, 429146.882080078 4272063.56292725, 429206.328918457 4271942.97070313, 429250.489501953 4271878.42828369, 429309.936279297 4271818.98150635, 429374.47869873 4271747.64532471, 429440.719482422 4271647.43487549, 429454.035522461 4271628.20050049, 429448.033325195 4271624.05529785, 429421.046875 4271610.56207275, 429365.916503906 4271627.26812744, 429338.490905762 4271635.57891846, 429283.453308105 4271633.07727051, 429228.415893555 4271593.05010986, 429123.344726563 4271593.05010986, 429060.802124023 4271600.55511475, 429020.774902344 4271625.57208252, 428973.242675781 4271628.07391357, 428918.205322266 4271620.56872559, 428860.66607666 4271575.53808594, 428825.64251709 4271550.52111816, 428768.103271484 4271523.00250244, 428716.286315918 4271499.97271729, 428717.396118164 4271494.26470947, 428712.301501591 4271477.14210741, 428719.723922293 4271454.09016726, 428722.955547033 4271441.78958324, 428728.828304883 4271425.67105917, 428729.827951638 4271418.50726035, 428736.236975926 4271401.76638861, 428741.793400878 4271382.24864532, 428743.957471553 4271365.30711591, 428744.269383656 4271335.33846318, 428744.566285492 4271317.33696686, 428745.614901569 4271305.04049332, 428748.420116962 4271286.72348278, 428749.796231191 4271276.75640668, 428751.868942683 4271262.60542431, 428754.299005306 4271248.02562619, 428758.372957239 4271219.93807002, 428761.160476599 4271188.49143085, 428764.434361084 4271137.89990714, 428764.872494441 4271122.36091853, 428769.28340483 4271078.36154829, 428769.757302983 4271069.26382899, 428772.590367132 4271027.06554001, 428773.798069582 4271001.78609552, 428774.079185372 4270998.73245403, 428774.913921884 4270949.37839431, 428774.204293084 4270913.91677033, 428772.122107628 4270865.98711863, 428771.838372344 4270855.23408468, 428773.318150673 4270844.53011557, 428775.050634028 4270835.55318734, 428780.100909252 4270790.34538381, 428784.686753611 4270766.19596127, 428792.734771497 4270731.20774981, 428794.458643568 4270722.90937756, 428794.57899859 4270709.11882827, 428796.022232004 4270703.46631556, 428801.59467552 4270688.03216015, 428810.366200872 4270669.59482599, 428818.767359242 4270650.39785934, 428836.588254563 4270604.0864203, 428851.21901531 4270562.06510468, 428866.56714803 4270513.81030537, 428867.594328434 4270509.55496356, 428877.839383492 4270474.23917697, 428882.314359826 4270455.60672456, 428882.527743974 4270437.37239723, 428883.594136873 4270428.36187324, 428886.426089531 4270412.80704813, 428888.819395593 4270394.55908695, 428895.217548497 4270372.32604307, 428901.402410764 4270353.7718536, 428903.659304251 4270330.14684781, 428874.832808761 4270325.60898832, 428858.794921875 4270306.70727539, 428855.768310547 4270277.19812012, 428848.12487793 4270270.25811768, 428849.819091797 4270267.13012695, 428823.483886719 4270247.8850708, 428816.173278809 4270242.54290771, 428803.467712402 4270238.59967041, 428743.624084473 4270220.02752686, 428658.56628418 4270205.01727295, 428543.488098145 4270167.49188232, 428523.040283203 4270151.66131592, 428465.93548584 4270107.45111084, 428375.874328613 4270062.42028809, 428328.342102051 4270014.88812256, 428302.42388916 4269988.13391113, 428109.041687012 4270153.89007568, 428082.871704102 4270165.7086792, 427803.862915039 4270291.71270752, 427637.964477539 4270415.55230713, 427594.543701172 4270352.59228516, 427481.311706543 4270246.15411377, 427469.340698242 4270204.25549316, 427455.56048584 4270214.84307861, 427370.706115723 4270311.40148926, 427295.231689453 4270590.32830811, 427273.960083008 4270805.70330811, 427270.844909668 4270837.24328613, 427229.676513672 4270915.76147461, 427192.206115723 4270990.7020874, 427173.81628418 4271026.36712646, 427173.81628418 4271108.80389404, 427223.038696289 4271164.58929443, 427446.180114746 4271236.78210449, 427532.732727051 4271268.83868408, 427545.307128906 4271273.34747314, 427533.384277344 4271282.06030273, 427448.460083008 4271344.90411377, 427341.455688477 4271423.03430176, 427203.878723145 4271516.45092773, 427118.954528809 4271572.50067139, 427001.759277344 4271638.74151611, 426932.121520996 4271681.20349121, 426861.12487793 4271725.36407471, 426781.296325684 4271772.92150879, 426771.8046875 4271778.47747803, 426761.397521973 4271774.22570801, 426698.195343056 4271819.56442287, 426633.391686283 4271866.30964792, 426569.585341218 4271911.92266905, 426519.060766893 4271939.89003449, 426466.69577514 4271956.32854418, 426344.694611861 4271973.51410076, 426292.733887524 4271988.28435953, 426245.706448097 4272008.82008836, 426186.148071289 4272029.39227295, 426113.539457872 4272061.11753452, 426046.872497559 4272104.12548828, 425980.631713867 4272148.28588867, 425930.016906738 4272172.06469727, 425867.173095703 4272209.43127441, 425780.550476074 4272253.5916748, 425719.494810936 4272288.35958823, 425627.687072754 4272330.02349854, 425518.619837223 4272364.01851458, 425426.651206409 4272396.81891866, 425405.934082031 4272403.58032227, 425277.798522949 4272383.64831543, 425193.784231838 4272356.20866998, 425184.84125954 4272353.3222504, 425165.883483887 4272348.8637085, 425152.272277832 4272320.12890625, 425157.432128906 4272272.39971924, 425157.891906738 4272257.30108643, 425157.957275391 4272257.24432373, 425157.896484375 4272257.15289307, 425138.235473633 4272217.83148193, 425138.235473633 4272183.046875, 425120.087280273 4272116.50292969, 425101.938720703 4272034.83508301, 425129.161499023 4271972.828125, 425130.095275879 4271942.00970459, 425130.67388916 4271922.91992188, 425129.524902344 4271912.00567627, 425127.273498535 4271890.61608887, 425120.964728378 4271868.3351658, 425045.925386737 4271955.40549024, 424956.443065219 4272059.67541768, 424871.877223662 4272161.23185975, 424811.200553532 4272243.57370714, 424676.820995328 4272403.31090795, 424643.373465723 4272441.65261447, 424609.261027663 4272476.07139052, 424504.855807228 4272610.00478028, 424388.931137197 4272748.44188245, 424252.156921387 4272963.72467041, 424159.306518555 4273058.83972168, 424068.72088623 4273124.51428223, 423984.929077148 4273187.92431641, 423946.783691406 4273218.91748047, 423946.518493652 4273219.13287354, 423957.718688965 4273233.85308838, 424023.092529297 4273319.77288818, 423952.972900391 4273481.0479126, 423942.468688965 4273505.20770264, 423922.762872741 4273550.5310475, 423940.122588518 4273565.01298366, 423968.270002408 4273578.00202319, 423983.01620382 4273585.80603303, 423997.498908748 4273598.86729147, 424020.844426703 4273618.65119188, 424029.965591511 4273627.56517205, 424042.818171341 4273635.54632393, 424056.810916584 4273641.55812838, 424089.460666358 4273653.89271799, 424102.727899133 4273653.78915297, 424112.263701568 4273657.00237201, 424120.141088669 4273661.97763466, 424138.694429633 4273670.37342417, 424179.947098287 4273690.79278861, 424195.18362856 4273699.60315783, 424206.481477269 4273704.0601912, 424210.520379899 4273706.12782656, 424218.769175571 4273712.59714678, 424225.860393698 4273717.34375391, 424241.015025896 4273725.49306844, 424268.779451446 4273741.10543128, 424274.269446153 4273741.76312267, 424295.543146091 4273748.91169545, 424330.084336834 4273757.08972827, 424345.523366525 4273761.53941396, 424354.771354737 4273764.16302091, 424368.971285132 4273767.37695786, 424401.699987349 4273775.67413722, 424426.918804968 4273780.82301127, 424437.675330063 4273783.90574874, 424452.563937473 4273787.775577, 424461.680756104 4273789.18579238, 424472.863618209 4273790.62881537, 424487.699752863 4273792.7176892, 424504.261833575 4273797.12782464, 424531.309960032 4273805.16405132, 424541.20801009 4273807.51613039, 424552.968078703 4273808.88821498, 424571.98020073 4273809.37834035, 424593.185953762 4273808.27294555, 424617.354521508 4273805.94860927, 424640.580681983 4273804.77275074, 424657.142803619 4273802.81284424, 424674.319198204 4273802.53445655, 424679.898727241 4273801.96930661, 424682.394017676 4273801.21609853, 424707.939602317 4273799.49557635, 424752.015691409 4273792.08367236, 424837.619772013 4273780.91188449, 424822.837524414 4273774.97192383, 424829.772521973 4273770.86248779, 424853.379516602 4273764.4821167, 424866.778320313 4273757.46368408, 424888.471130371 4273741.51312256, 424914.630310059 4273721.73413086, 424926.547485352 4273717.03948975, 425008.067077637 4273687.50170898, 425038.408081055 4273677.07208252, 425113.695678711 4273663.67352295, 425213.228271484 4273657.29309082, 425301.276489258 4273647.72271729, 425335.091918945 4273643.89447021, 425379.754089355 4273638.7902832, 425426.968078613 4273629.21990967, 425462.697875977 4273619.6494751, 425491.51514497 4273610.54613559, 425497.581035818 4273606.39289826, 425526.534260533 4273602.5926642, 425545.136344634 4273598.24230283, 425552.987225269 4273596.24213218, 425561.738209571 4273593.59189545, 425578.090054581 4273587.74135381, 425585.240861689 4273585.14111233, 425593.84183712 4273581.29074199, 425621.194943431 4273568.38949168, 425636.947159605 4273564.13566664, 425660.991685604 4273554.16389311, 425745.983093262 4273531.60150146, 425810.424072266 4273520.75488281, 425821.0625 4273520.40130615, 425831.799316406 4273520.04449463, 425836.016113281 4273519.90429688, 425869.831726074 4273514.16192627, 425906.199279785 4273505.22949219, 425939.37689209 4273499.48730469, 425979.974790314 4273481.86933383, 425985.310277156 4273481.05744699, 425990.297801283 4273479.70427717, 426002.476649583 4273474.7941658, 426009.358664016 4273472.24245793, 426013.611596323 4273470.34800265, 426020.458223583 4273464.50173346, 426059.964477539 4273446.53088379, 426076.806274414 4273436.67987061, 426116.342918483 4273413.55484837, 426116.088369245 4273411.28812039, 426163.591281539 4273380.62078611, 426177.222717372 4273371.91568553, 426185.118155269 4273366.51716996, 426202.393653269 4273353.15582935, 426211.846055907 4273345.29053256, 426248.956522581 4273316.58084181, 426267.205078125 4273305.66967773, 426268.600280762 4273304.88830566, 426280.722717285 4273318.92492676, 426281.694274902 4273319.70568848, 426316.452514648 4273347.6362915, 426420.451293945 4273422.28588867, 426475.959899902 4273435.04650879, 426690.028875598 4273497.17574667, 426692.718111404 4273492.4130262, 426771.053897008 4273517.49875311, 426864.884325239 4273547.54638052, 426918.668592389 4273564.76989373, 426927.924072266 4273571.02648926, 426994.917114258 4273600.2164917, 427047.554504395 4273623.18548584, 427050.045471191 4273623.95812988, 427077.923095703 4273632.60528564, 427151.296508789 4273657.48852539, 427209.995117188 4273679.18151855, 427293.577087402 4273700.87451172, 427354.593688965 4273715.5637207, 427362.484130859 4273717.46331787, 427472.86328125 4273757.02111816, 427574.310119629 4273787.64648438, 427627.90447998 4273804.23529053, 427709.57232666 4273830.39447021, 427779.117675781 4273857.19189453, 427884.036499023 4273895.11431885, 427885.030517578 4273895.47369385, 427922.674316406 4273908.23431396, 427937.762512207 4273916.30432129, 427960.911071777 4273893.42510986, 427978.137878418 4273873.23730469, 428011.514892578 4273828.28607178, 428057.273498535 4273772.83752441, 428099.533081055 4273720.3494873, 428136.947509766 4273668.39990234, 428146.086120605 4273652.4072876))",
            //    "GEOMETRYCOLLECTION(LINESTRING(428874.832808761 4270325.60898832, 428903.659304251 4270330.14684781),POLYGON((428621.982791055 4270285.44356732, 428624.488683231 4270287.13256622, 428762.819684007 4270307.97591107, 428874.832808761 4270325.60898832, 428858.794921875 4270306.70727539, 428855.768310547 4270277.19812012, 428848.12487793 4270270.25811768, 428849.819091797 4270267.13012695, 428823.483886719 4270247.8850708, 428816.173278809 4270242.54290771, 428803.467712402 4270238.59967041, 428743.624084473 4270220.02752686, 428739.283285116 4270219.2615007, 428621.982791055 4270285.44356732)))",
            //    13863.92140839994);
        }

        void Union()
        {
            ValidateUnion(
                "POLYGON ((-62.2199591369113 23.7270874540685, -3.56415438320363 23.7270874540685, -3.56415438320363 5.60081445726297, -62.2199591369113 5.60081445726297, -62.2199591369113 23.7270874540685))",
                "POLYGON ((-7.98300736649545 14.9694499387579, -8.0012358264364 14.2269048028203, -8.05587729230264 13.4861485231544, -8.14680012801686 12.7489656465206, -8.27378529250394 12.0171321110382, -8.4365268673800191 11.2924109677953, -8.63463279393676 10.5765481335041, -8.86762581764506 9.87126818443443, -9.13494463790302 9.17827020175892, -9.43594526025828 8.49922367831729, -9.76990254784704 7.83576449666194, -10.1360119683123 7.18949098807365, -10.5333915319927 6.56196008204147, -10.9610839167132 5.95468355548327, -11.4180587740573 5.36912439074265, -11.9032152115676 4.80669325113641, -12.4153844448913 4.268745082543, -12.9533326134847 3.75657584921926, -13.515763753091 3.271419411709, -14.1013229178316 2.81444455436485, -14.7085994443898 2.38675216964445, -15.336130350422 1.98937260596399, -15.9824038590102 1.62326318549873, -16.6458630406656 1.28930589790997, -17.3249095641072 0.988305275554719, -18.0179075467827 0.720986455296758, -18.7231874958524 0.487993431588462, -19.4390503301437 0.289887505031718, -20.1637714733865 0.127145930155631, -20.8956050088689 0.000160765668560714, -21.6327878855027 -0.0907620700456597, -22.3735441651686 -0.145403535911896, -23.1160893011062 -0.16363199585285, -23.8586344370438 -0.145403535911894, -24.5993907167097 -0.090762070045658, -25.3365735933435 0.000160765668566043, -26.0684071288259 0.127145930155638, -26.7931282720688 0.289887505031725, -27.50899110636 0.487993431588469, -28.2142710554297 0.720986455296771, -28.9072690381052 0.98830527555473, -29.5863155615468 1.28930589790999, -30.2497747432022 1.62326318549875, -30.8960482517905 1.989372605964, -31.5235791578226 2.38675216964446, -32.1308556843808 2.81444455436486, -32.7164148491215 3.27141941170901, -33.2788459887277 3.75657584921927, -33.8167941573211 4.26874508254301, -34.3289633906448 4.80669325113641, -34.8141198281551 5.36912439074265, -35.2710946854992 5.95468355548327, -35.6987870702196 6.56196008204147, -36.0961666339001 7.18949098807364, -36.4622760543654 7.83576449666193, -36.7962333419541 8.49922367831728, -37.0972339643094 9.17827020175891, -37.3645527845673 9.87126818443441, -37.5975458082756 10.5765481335041, -37.7956517348324 11.2924109677953, -37.9583933097085 12.0171321110382, -38.0853784741955 12.7489656465206, -38.1763013099098 13.4861485231544, -38.230942775776 14.2269048028203, -38.249171235717 14.9694499387579, -38.230942775776 15.7119950746955, -38.1763013099098 16.4527513543613, -38.0853784741955 17.1899342309952, -37.9583933097085 17.9217677664775, -37.7956517348324 18.6464889097204, -37.5975458082757 19.3623517440117, -37.3645527845674 20.0676316930813, -37.0972339643094 20.7606296757568, -36.7962333419542 21.4396761991985, -36.4622760543654 22.1031353808538, -36.0961666339001 22.7494088894421, -35.6987870702197 23.3769397954743, -35.2710946854993 23.9842163220325, -34.8141198281551 24.5697754867731, -34.3289633906449 25.1322066263793, -33.8167941573212 25.6701547949727, -33.2788459887278 26.1823240282965, -32.7164148491215 26.6674804658068, -32.1308556843809 27.1244553231509, -31.5235791578227 27.5521477078713, -30.8960482517905 27.9495272715518, -30.2497747432022 28.315636692017, -29.5863155615469 28.6495939796058, -28.9072690381053 28.950594601961, -28.2142710554298 29.217913422219, -27.5089911063601 29.4509064459273, -26.7931282720688 29.6490123724841, -26.068407128826 29.8117539473601, -25.3365735933436 29.9387391118472, -24.5993907167098 30.0296619475614, -23.8586344370439 30.0843034134277, -23.1160893011063 30.1025318733686, -22.3735441651687 30.0843034134277, -21.6327878855028 30.0296619475615, -20.895605008869 29.9387391118473, -20.1637714733867 29.8117539473602, -19.4390503301438 29.6490123724841, -18.7231874958525 29.4509064459274, -18.0179075467828 29.2179134222191, -17.3249095641073 28.9505946019611, -16.6458630406657 28.6495939796059, -15.9824038590104 28.3156366920171, -15.3361303504221 27.9495272715519, -14.7085994443899 27.5521477078714, -14.1013229178317 27.124455323151, -13.5157637530911 26.6674804658069, -12.9533326134848 26.1823240282966, -12.4153844448914 25.6701547949729, -11.9032152115677 25.1322066263795, -11.4180587740574 24.5697754867733, -10.9610839167133 23.9842163220327, -10.5333915319928 23.3769397954745, -10.1360119683124 22.7494088894423, -9.76990254784712 22.103135380854, -9.43594526025835 21.4396761991987, -9.13494463790309 20.760629675757, -8.86762581764512 20.0676316930815, -8.63463279393681 19.3623517440119, -8.43652686738006 18.6464889097206, -8.27378529250397 17.9217677664777, -8.14680012801689 17.1899342309954, -8.05587729230266 16.4527513543616, -8.00123582643641 15.7119950746957, -7.98300736649545 14.9694499387581, -7.98300736649545 14.9694499387579))",
                "POLYGON ((-62.2199591369113 23.7270874540685, -35.4521852660018 23.7270874540685, -35.2710946854993 23.9842163220325, -34.8141198281551 24.5697754867731, -34.3289633906449 25.1322066263793, -33.8167941573212 25.6701547949727, -33.2788459887278 26.1823240282965, -32.7164148491215 26.6674804658068, -32.1308556843809 27.1244553231509, -31.5235791578227 27.5521477078713, -30.8960482517905 27.9495272715518, -30.2497747432022 28.315636692017, -29.5863155615469 28.6495939796058, -28.9072690381053 28.950594601961, -28.2142710554298 29.217913422219, -27.5089911063601 29.4509064459273, -26.7931282720688 29.6490123724841, -26.068407128826 29.8117539473601, -25.3365735933436 29.9387391118472, -24.5993907167098 30.0296619475614, -23.8586344370439 30.0843034134277, -23.1160893011063 30.1025318733686, -22.3735441651687 30.0843034134277, -21.6327878855028 30.0296619475615, -20.895605008869 29.9387391118473, -20.1637714733867 29.8117539473602, -19.4390503301438 29.6490123724841, -18.7231874958525 29.4509064459274, -18.0179075467828 29.2179134222191, -17.3249095641073 28.9505946019611, -16.6458630406657 28.6495939796059, -15.9824038590104 28.3156366920171, -15.3361303504221 27.9495272715519, -14.7085994443899 27.5521477078714, -14.1013229178317 27.124455323151, -13.5157637530911 26.6674804658069, -12.9533326134848 26.1823240282966, -12.4153844448914 25.6701547949729, -11.9032152115677 25.1322066263795, -11.4180587740574 24.5697754867733, -10.9610839167133 23.9842163220327, -10.7799933362106 23.7270874540685, -3.56415438320363 23.7270874540685, -3.56415438320363 5.60081445726297, -11.2372460714791 5.60081445726297, -11.4180587740573 5.36912439074265, -11.9032152115676 4.80669325113641, -12.4153844448913 4.268745082543, -12.9533326134847 3.75657584921926, -13.515763753091 3.271419411709, -14.1013229178316 2.81444455436485, -14.7085994443898 2.38675216964445, -15.336130350422 1.98937260596399, -15.9824038590102 1.62326318549873, -16.6458630406656 1.28930589790997, -17.3249095641072 0.988305275554719, -18.0179075467827 0.720986455296758, -18.7231874958524 0.487993431588462, -19.4390503301437 0.289887505031718, -20.1637714733865 0.127145930155631, -20.8956050088689 0.000160765668560714, -21.6327878855027 -0.0907620700456597, -22.3735441651686 -0.145403535911896, -23.1160893011062 -0.16363199585285, -23.8586344370438 -0.145403535911894, -24.5993907167097 -0.090762070045658, -25.3365735933435 0.000160765668566043, -26.0684071288259 0.127145930155638, -26.7931282720688 0.289887505031725, -27.50899110636 0.487993431588469, -28.2142710554297 0.720986455296771, -28.9072690381052 0.98830527555473, -29.5863155615468 1.28930589790999, -30.2497747432022 1.62326318549875, -30.8960482517905 1.989372605964, -31.5235791578226 2.38675216964446, -32.1308556843808 2.81444455436486, -32.7164148491215 3.27141941170901, -33.2788459887277 3.75657584921927, -33.8167941573211 4.26874508254301, -34.3289633906448 4.80669325113641, -34.8141198281551 5.36912439074265, -34.9949325307333 5.60081445726297, -62.2199591369113 5.60081445726297, -62.2199591369113 23.7270874540685))",
                1268.8604573139);

            ValidateUnion(
                "POLYGON((-3.5641543832036 0.305498750331051, -3.59531060777697 -0.963665133292487, -3.68870422342312 -2.22977148995475, -3.84411023674165 -3.48977015854472, -4.06115426103451 -4.7406256919069, -4.33931341823636 -5.97932466949944, -4.67791759857365 -7.20288295698809, -5.07615107491772 -8.40835289528725, -5.53305446794292 -9.59283040172885, -6.04752705735544 -10.7534619662519, -6.61832943362492 -11.8874515257581, -7.24408648383053 -12.992067200073, -7.9232907044285 -14.0646478732841, -8.65430583296012 -15.1026096046027, -9.43537078995141 -16.1034518533034, -10.2646039215078 -17.0647635027456, -11.140007532383 -17.9842286689648, -12.0594726986023 -18.8596322798401, -13.0207843480445 -19.6888654113964, -14.0216265967452 -20.4699303683877, -15.0595883280638 -21.2009454969194, -16.1321690012749 -21.8801497175173, -17.2367846755897 -22.5059067677229, -18.370774235096 -23.0767091439924, -19.531405799619 -23.5911817334049, -20.7158833060606 -24.0480851264301, -21.9213532443598 -24.4463186027742, -23.1449115318484 -24.7849227831115, -24.383610509441 -25.0630819403134, -25.6344660428032 -25.2801259646062, -26.8944647113931 -25.4355319779247, -28.1605710680554 -25.5289255935709, -29.4297349516789 -25.5600818181442, -30.6988988353025 -25.5289255935709, -31.9650051919647 -25.4355319779247, -33.2250038605547 -25.2801259646062, -34.4758593939169 -25.0630819403133, -35.7145583715094 -24.7849227831115, -36.9381166589981 -24.4463186027742, -38.1435865972972 -24.0480851264301, -39.3280641037388 -23.5911817334049, -40.4886956682619 -23.0767091439924, -41.6226852277681 -22.5059067677229, -42.7273009020829 -21.8801497175173, -43.799881575294 -21.2009454969193, -44.8378433066127 -20.4699303683877, -45.8386855553133 -19.6888654113964, -46.7999972047555 -18.8596322798401, -47.7194623709748 -17.9842286689648, -48.59486598185 -17.0647635027456, -49.4240991134064 -16.1034518533034, -50.2051640703977 -15.1026096046027, -50.9361791989293 -14.0646478732841, -51.6153834195273 -12.992067200073, -52.2411404697329 -11.8874515257582, -52.8119428460023 -10.7534619662519, -53.3264154354149 -9.59283040172887, -53.7833188284401 -8.40835289528728, -54.1815523047841 -7.20288295698813, -54.5201564851214 -5.97932466949948, -54.7983156423233 -4.74062569190695, -55.0153596666161 -3.48977015854476, -55.1707656799347 -2.2297714899548, -55.2641592955808 -0.963665133292543, -55.2953155201542 0.30549875033099, -55.2641592955808 1.57466263395452, -55.1707656799347 2.84076899061678, -55.0153596666162 4.10076765920674, -54.7983156423233 5.35162319256893, -54.5201564851215 6.59032217016146, -54.1815523047842 7.81388045765011, -53.7833188284401 9.01935039594926, -53.3264154354149 10.2038279023909, -52.8119428460024 11.3644594669139, -52.2411404697329 12.4984490264201, -51.6153834195273 13.603064700735, -50.9361791989294 14.6756453739461, -50.2051640703978 15.7136071052647, -49.4240991134065 16.7144493539654, -48.5948659818501 17.6757610034076, -47.7194623709749 18.5952261696268, -46.7999972047556 19.4706297805021, -45.8386855553134 20.2998629120585, -44.8378433066127 21.0809278690498, -43.7998815752941 21.8119429975814, -42.727300902083 22.4911472181793, -41.6226852277682 23.116904268385, -40.488695668262 23.6877066446544, -39.3280641037389 24.202179234067, -38.1435865972973 24.6590826270922, -36.9381166589982 25.0573161034363, -35.7145583715096 25.3959202837736, -34.475859393917 25.6740794409754, -33.2250038605548 25.8911234652683, -31.9650051919649 26.0465294785868, -30.6988988353026 26.139923094233, -29.4297349516791 26.1710793188064, -28.1605710680556 26.139923094233, -26.8944647113933 26.0465294785868, -25.6344660428033 25.8911234652683, -24.3836105094411 25.6740794409755, -23.1449115318486 25.3959202837736, -21.92135324436 25.0573161034364, -20.7158833060608 24.6590826270923, -19.5314057996192 24.2021792340671, -18.3707742350962 23.6877066446546, -17.2367846755899 23.1169042683851, -16.1321690012751 22.4911472181795, -15.059588328064 21.8119429975816, -14.0216265967454 21.08092786905, -13.0207843480447 20.2998629120587, -12.0594726986025 19.4706297805024, -11.1400075323832 18.5952261696271, -10.2646039215079 17.6757610034079, -9.43537078995158 16.7144493539657, -8.65430583296028 15.713607105265, -7.92329070442865 14.6756453739464, -7.24408648383068 13.6030647007353, -6.61832943362505 12.4984490264205, -6.04752705735557 11.3644594669143, -5.53305446794303 10.2038279023912, -5.07615107491782 9.01935039594963, -4.67791759857374 7.81388045765048, -4.33931341823644 6.59032217016184, -4.06115426103457 5.35162319256931, -3.84411023674169 4.10076765920713, -3.68870422342315 2.84076899061717, -3.59531060777699 1.57466263395491, -3.5641543832036 0.305498750331379, -3.5641543832036 0.305498750331051))",
                "POLYGON((-55.2953155201542 -26.9857437392412, -3.56415438320365 -26.9857437392412, -3.56415438320365 0.305498750331051, -55.2953155201542 0.305498750331051, -55.2953155201542 -26.9857437392412))",
                "POLYGON((-3.5641543832036 0.305498750331051, -3.56415438320365 0.305498750329007, -3.56415438320365 -26.9857437392412, -55.2953155201542 -26.9857437392412, -55.2953155201542 0.30549875033099, -55.2953155201542 0.305498750331051, -55.2641592955808 1.57466263395452, -55.1707656799347 2.84076899061678, -55.0153596666162 4.10076765920674, -54.7983156423233 5.35162319256893, -54.5201564851215 6.59032217016146, -54.1815523047842 7.81388045765011, -53.7833188284401 9.01935039594926, -53.3264154354149 10.2038279023909, -52.8119428460024 11.3644594669139, -52.2411404697329 12.4984490264201, -51.6153834195273 13.603064700735, -50.9361791989294 14.6756453739461, -50.2051640703978 15.7136071052647, -49.4240991134065 16.7144493539654, -48.5948659818501 17.6757610034076, -47.7194623709749 18.5952261696268, -46.7999972047556 19.4706297805021, -45.8386855553134 20.2998629120585, -44.8378433066127 21.0809278690498, -43.7998815752941 21.8119429975814, -42.727300902083 22.4911472181793, -41.6226852277682 23.116904268385, -40.488695668262 23.6877066446544, -39.3280641037389 24.202179234067, -38.1435865972973 24.6590826270922, -36.9381166589982 25.0573161034363, -35.7145583715096 25.3959202837736, -34.475859393917 25.6740794409754, -33.2250038605548 25.8911234652683, -31.9650051919649 26.0465294785868, -30.6988988353026 26.139923094233, -29.4297349516791 26.1710793188064, -28.1605710680556 26.139923094233, -26.8944647113933 26.0465294785868, -25.6344660428033 25.8911234652683, -24.3836105094411 25.6740794409755, -23.1449115318486 25.3959202837736, -21.92135324436 25.0573161034364, -20.7158833060608 24.6590826270923, -19.5314057996192 24.2021792340671, -18.3707742350962 23.6877066446546, -17.2367846755899 23.1169042683851, -16.1321690012751 22.4911472181795, -15.059588328064 21.8119429975816, -14.0216265967454 21.08092786905, -13.0207843480447 20.2998629120587, -12.0594726986025 19.4706297805024, -11.1400075323832 18.5952261696271, -10.2646039215079 17.6757610034079, -9.43537078995158 16.7144493539657, -8.65430583296028 15.713607105265, -7.92329070442865 14.6756453739464, -7.24408648383068 13.6030647007353, -6.61832943362505 12.4984490264205, -6.04752705735557 11.3644594669143, -5.53305446794303 10.2038279023912, -5.07615107491782 9.01935039594963, -4.67791759857374 7.81388045765048, -4.33931341823644 6.59032217016184, -4.06115426103457 5.35162319256931, -3.84411023674169 4.10076765920713, -3.68870422342315 2.84076899061717, -3.59531060777699 1.57466263395491, -3.5641543832036 0.305498750331379, -3.5641543832036 0.305498750331051))",
                2462.29280482249);

            ValidateUnion(
                "POLYGON((-38.7772212552669 -4.10385036372272, -45.3098843022799 23.3668352698702, -22.6968199087735 32.0770526658875, -10.9715272602887 10.8040217179222, -38.7772212552669 -4.10385036372272),(-33.7520958344877 8.12395482684, -22.6968199087735 8.12395482684, -22.6968199087735 21.1892809208659, -33.7520958344877 21.1892809208659, -33.7520958344877 8.12395482684))",
                "POLYGON((-13.7938505837464 8.12395482684002, -13.8045746002024 7.6871068274526, -13.8367208144755 7.25131123315906, -13.8902117835197 6.81761791371726, -13.9649186429054 6.38707167432077, -14.0606614172649 5.9607097385717, -14.1772094538685 5.53955924971815, -14.3142819782878 5.12463479617621, -14.4715487708051 4.71693596729754, -14.6486309619426 4.31744494527112, -14.845101945191 3.92712413896029, -15.0604884047429 3.54691386537551, -15.2942714557518 3.17773008436834, -15.5458878943706 2.82046219200391, -15.8147315545598 2.47597087792788, -16.100154768394 2.14508605188975, -16.401469926351 1.82860484441754, -16.7179511338232 1.52728968646051, -17.0488359598614 1.24186647262628, -17.3933272739374 0.973022812437098, -17.7505951663018 0.721406373818283, -18.119778947309 0.487623322809464, -18.4999892208938 0.272236863257498, -18.8903100272046 0.0757658800090706, -19.289801049231 -0.101316311128345, -19.6974998781097 -0.258583103645732, -20.1124243316516 -0.39565562806497, -20.5335748205052 -0.512203664668602, -20.9599367562543 -0.607946439028044, -21.3904829956508 -0.68265329841379, -21.8241763150926 -0.736144267458027, -22.2599719093861 -0.768290481731077, -22.6968199087735 -0.779014498187079, -23.1336679081609 -0.768290481731077, -23.5694635024545 -0.736144267458027, -24.0031568218963 -0.682653298413786, -24.4337030612928 -0.607946439028041, -24.8600649970418 -0.512203664668597, -25.2812154858954 -0.395655628064967, -25.6961399394373 -0.258583103645725, -26.103838768316 -0.101316311128338, -26.5033297903424 0.0757658800090795, -26.8936505966532 0.272236863257506, -27.273860870238 0.487623322809471, -27.6430446512452 0.72140637381829, -28.0003125436096 0.973022812437104, -28.3448038576856 1.24186647262629, -28.6756886837238 1.52728968646051, -28.992169891196 1.82860484441754, -29.293485049153 2.14508605188976, -29.5789082629872 2.47597087792788, -29.8477519231764 2.82046219200391, -30.0993683617952 3.17773008436834, -30.333151412804 3.54691386537551, -30.548537872356 3.92712413896028, -30.7450088556044 4.31744494527112, -30.9220910467419 4.71693596729754, -31.0793578392592 5.1246347961762, -31.2164303636785 5.53955924971814, -31.3329784002821 5.96070973857168, -31.4287211746416 6.38707167432076, -31.5034280340273 6.81761791371725, -31.5569190030715 7.25131123315905, -31.5890652173446 7.68710682745258, -31.5997892338006 8.12395482684, -31.5890652173446 8.56080282622742, -31.5569190030716 8.99659842052095, -31.5034280340273 9.43029173996275, -31.4287211746416 9.86083797935924, -31.3329784002821 10.2871999151083, -31.2164303636785 10.7083504039619, -31.0793578392593 11.1232748575038, -30.9220910467419 11.5309736863825, -30.7450088556045 11.9304647084089, -30.548537872356 12.3207855147197, -30.3331514128041 12.7009957883045, -30.0993683617953 13.0701795693117, -29.8477519231764 13.4274474616761, -29.5789082629873 13.7719387757521, -29.293485049153 14.1028236017903, -28.992169891196 14.4193048092625, -28.6756886837238 14.7206199672195, -28.3448038576857 15.0060431810537, -28.0003125436096 15.2748868412429, -27.6430446512452 15.5265032798617, -27.273860870238 15.7602863308706, -26.8936505966533 15.9756727904225, -26.5033297903424 16.1721437736709, -26.103838768316 16.3492259648084, -25.6961399394374 16.5064927573258, -25.2812154858954 16.643565281745, -24.8600649970419 16.7601133183486, -24.4337030612928 16.8558560927081, -24.0031568218963 16.9305629520938, -23.5694635024545 16.9840539211381, -23.133667908161 17.0162001354111, -22.6968199087736 17.0269241518671, -22.2599719093861 17.0162001354111, -21.8241763150926 16.9840539211381, -21.3904829956508 16.9305629520938, -20.9599367562543 16.8558560927081, -20.5335748205052 16.7601133183487, -20.1124243316517 16.643565281745, -19.6974998781098 16.5064927573258, -19.2898010492311 16.3492259648084, -18.8903100272047 16.172143773671, -18.4999892208938 15.9756727904226, -18.1197789473091 15.7602863308706, -17.7505951663019 15.5265032798618, -17.3933272739375 15.274886841243, -17.0488359598614 15.0060431810538, -16.7179511338233 14.7206199672196, -16.4014699263511 14.4193048092626, -16.100154768394 14.1028236017904, -15.8147315545598 13.7719387757522, -15.5458878943706 13.4274474616762, -15.2942714557518 13.0701795693118, -15.060488404743 12.7009957883046, -14.845101945191 12.3207855147198, -14.6486309619426 11.930464708409, -14.4715487708052 11.5309736863826, -14.3142819782878 11.1232748575039, -14.1772094538685 10.708350403962, -14.0606614172649 10.2871999151084, -13.9649186429055 9.86083797935937, -13.8902117835197 9.43029173996289, -13.8367208144755 8.99659842052108, -13.8045746002024 8.56080282622755, -13.7938505837464 8.12395482684013, -13.7938505837464 8.12395482684002))",
                "POLYGON((-38.7772212552669 -4.10385036372272, -45.3098843022799 23.3668352698702, -22.6968199087735 32.0770526658875, -10.9715272602887 10.8040217179222, -13.8681029861865 9.25103834680832, -13.8367208144755 8.99659842052108, -13.8045746002024 8.56080282622755, -13.7938505837464 8.12395482684013, -13.7938505837464 8.12395482684002, -13.8045746002024 7.6871068274526, -13.8367208144755 7.25131123315906, -13.8902117835197 6.81761791371726, -13.9649186429054 6.38707167432077, -14.0606614172649 5.9607097385717, -14.1772094538685 5.53955924971815, -14.3142819782878 5.12463479617621, -14.4715487708051 4.71693596729754, -14.6486309619426 4.31744494527112, -14.845101945191 3.92712413896029, -15.0604884047429 3.54691386537551, -15.2942714557518 3.17773008436834, -15.5458878943706 2.82046219200391, -15.8147315545598 2.47597087792788, -16.100154768394 2.14508605188975, -16.401469926351 1.82860484441754, -16.7179511338232 1.52728968646051, -17.0488359598614 1.24186647262628, -17.3933272739374 0.973022812437098, -17.7505951663018 0.721406373818283, -18.119778947309 0.487623322809464, -18.4999892208938 0.272236863257498, -18.8903100272046 0.0757658800090706, -19.289801049231 -0.101316311128345, -19.6974998781097 -0.258583103645732, -20.1124243316516 -0.39565562806497, -20.5335748205052 -0.512203664668602, -20.9599367562543 -0.607946439028044, -21.3904829956508 -0.68265329841379, -21.8241763150926 -0.736144267458027, -22.2599719093861 -0.768290481731077, -22.6968199087735 -0.779014498187079, -23.1336679081609 -0.768290481731077, -23.5694635024545 -0.736144267458027, -24.0031568218963 -0.682653298413786, -24.4337030612928 -0.607946439028041, -24.8600649970418 -0.512203664668597, -25.2812154858954 -0.395655628064967, -25.6961399394373 -0.258583103645725, -26.103838768316 -0.101316311128338, -26.5033297903424 0.0757658800090795, -26.8936505966532 0.272236863257506, -27.273860870238 0.487623322809471, -27.6430446512452 0.72140637381829, -28.0003125436096 0.973022812437104, -28.3448038576856 1.24186647262629, -28.521795528605 1.39454053792133, -38.7772212552669 -4.10385036372272),(-33.7520958344877 8.12395482684, -31.5997892338006 8.12395482684, -31.5890652173446 8.56080282622742, -31.5569190030716 8.99659842052095, -31.5034280340273 9.43029173996275, -31.4287211746416 9.86083797935924, -31.3329784002821 10.2871999151083, -31.2164303636785 10.7083504039619, -31.0793578392593 11.1232748575038, -30.9220910467419 11.5309736863825, -30.7450088556045 11.9304647084089, -30.548537872356 12.3207855147197, -30.3331514128041 12.7009957883045, -30.0993683617953 13.0701795693117, -29.8477519231764 13.4274474616761, -29.5789082629873 13.7719387757521, -29.293485049153 14.1028236017903, -28.992169891196 14.4193048092625, -28.6756886837238 14.7206199672195, -28.3448038576857 15.0060431810537, -28.0003125436096 15.2748868412429, -27.6430446512452 15.5265032798617, -27.273860870238 15.7602863308706, -26.8936505966533 15.9756727904225, -26.5033297903424 16.1721437736709, -26.103838768316 16.3492259648084, -25.6961399394374 16.5064927573258, -25.2812154858954 16.643565281745, -24.8600649970419 16.7601133183486, -24.4337030612928 16.8558560927081, -24.0031568218963 16.9305629520938, -23.5694635024545 16.9840539211381, -23.133667908161 17.0162001354111, -22.6968199087736 17.0269241518671, -22.6968199087735 17.0269241518671, -22.6968199087735 21.1892809208659, -33.7520958344877 21.1892809208659, -33.7520958344877 8.12395482684))",
                709.090544451707);
        }

        void Buffer()
        {
            var p0 = GeometryFactory.Read("POLYGON ((421027.304132467 4538277.2508368, 421044.554810854 4538292.47140001, 421020.70452139754 4538318.3017127486, 421010.568395469 4538306.9021948, 421003.463066495 4538299.09555234, 421027.304132467 4538277.2508368))");
            var p1 = GeometryFactory.Read("POLYGON ((563770.979158942 4589694.83810278, 563791.222387148 4589696.35466283, 563789.085755822 4589724.87467793, 563795.019113982 4589725.31918678, 563794.918258974 4589726.6654117, 563816.607519476 4589728.29030402, 563814.904183238 4589751.02664352, 563813.956752849 4589750.95566497, 563813.855905576 4589752.30178664, 563806.177513231 4589751.72654524, 563806.278360503 4589750.38042356, 563784.838423265 4589748.77410295, 563785.256784581 4589743.18976516, 563783.711120824 4589743.07396881, 563783.020072968 4589752.29815974, 563762.278242855 4589750.74424598, 563764.526939684 4589720.7283669, 563782.476599044 4589722.07309987, 563782.693250345 4589719.18121193, 563769.231005917 4589718.17266221, 563770.979158942 4589694.83810278))");
            var p2 = GeometryFactory.Read("POLYGON ((3658308.9859313 4856089.55254751, 3658323.45169803 4856089.55254751, 3658323.45169803 4856090.84197519, 3658332.27621869 4856090.84197519, 3658332.27621869 4856076.85974383, 3658328.64970335 4856076.85974383, 3658328.64970335 4856075.36884308, 3658325.30525032 4856075.36884308, 3658325.30525032 4856063.96546708, 3658308.9859313 4856063.99012162, 3658308.9859313 4856089.55254751))");
            var l0 = GeometryFactory.Read("LINESTRING (421057.512347283 4538295.84529646, 421084.375019463 4538299.16702474, 421095.062319148 4538316.35335801, 421105.027503989 4538294.68991271, 421121.924991329 4538318.23085661, 421131.601330233 4538306.2437502, 421165.396304911 4538310.28759333)") as ILineString;

            //Debug.Assert(p0.Buffer(+3.5).IsEquivalent(GeometryFactory.FromWkt("POLYGON((421024.939660671 4538274.67028005, 421001.098594699 4538296.51499559, 421001.0985947 4538296.51499559, 421000.512307845 4538297.21326028, 421000.126264495 4538298.03926052, 420999.96666221 4538298.93694251, 421000.044331873 4538299.84538804, 421000.354002687 4538300.70294845, 421000.874659866 4538301.45142821, 421007.966321823 4538309.24305468, 421018.088955798 4538320.62739901, 421018.828227066 4538321.25628879, 421019.711785273 4538321.65797183, 421020.671684836 4538321.80155871, 421021.634109529 4538321.67600763, 421022.525048944 4538321.29097344, 421023.275989886 4538320.67606526, 421047.126279342 4538294.84575252, 421047.12627934 4538294.84575252, 421047.65929749 4538294.08761866, 421047.974653039 4538293.21616805, 421048.050235693 4538292.29250006, 421047.880746182 4538291.38137515, 421047.4780678 4538290.54667436, 421046.87043324 4538289.84692045, 421029.619754853 4538274.62635724, 421028.916771071 4538274.14448899, 421028.118163321 4538273.84681656, 421027.271286318 4538273.75099093, 421026.426356979 4538273.86269421, 421025.633476733 4538274.17530279, 421024.939660671 4538274.67028005))")));
            //Debug.Assert(p0.Buffer(-3.5).IsEquivalent(GeometryFactory.Read("POLYGON((421027.348303713 4538281.95740191, 421008.399526419 4538299.31948841, 421013.156802098 4538304.54631893, 421013.183961069 4538304.57650854, 421020.753424356 4538313.08944861, 421039.554701334 4538292.7273115, 421027.348303713 4538281.95740191))")));

            //Debug.Assert(l0.Offset(+3.5, JoinStyle.Round).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.082823008 4538299.3188406, 421082.285891006 4538302.43534901, 421092.090123215 4538318.20161431, 421092.688901214 4538318.92568911, 421093.458724062 4538319.46438401, 421094.344113022 4538319.77887694, 421095.281260864 4538319.84650337, 421096.202630258 4538319.66238968, 421097.041820975 4538319.23980436, 421097.738355151 4538318.60920182, 421098.242035732 4538317.81602764, 421105.692734422 4538301.61885658, 421119.081646378 4538320.2717852, 421119.709585435 4538320.94046483, 421120.489698444 4538321.42302426, 421121.368400246 4538321.68631698, 421122.285333718 4538321.71225767, 421123.177515642 4538321.4990645, 421123.983662958 4538321.0613815, 421124.648402234 4538320.42927264, 421133.108345523 4538309.94904438, 421164.980467902 4538313.76280262)")));
            //Debug.Assert(l0.Offset(-3.5, JoinStyle.Round).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.941871558 4538292.37175232, 421084.804543738 4538295.6934806, 421085.802744589 4538295.97146517, 421086.675809078 4538296.52953215, 421087.347215396 4538297.31876844, 421094.600336457 4538308.98257122, 421101.847787405 4538293.22724308, 421102.332882397 4538292.45630252, 421103.00047839 4538291.83663964, 421103.805360523 4538291.41022288, 421104.693015839 4538291.20593256, 421105.603325328 4538291.23760482, 421106.474635659 4538291.50309456, 421107.247934834 4538291.98442073, 421107.87084894 4538292.64898413, 421122.088358079 4538312.45628318, 421128.877919328 4538304.04533417, 421129.514026775 4538303.43427262, 421130.282704214 4538303.00164819, 421131.135130973 4538302.77493798, 421132.017167242 4538302.76854091, 421165.81214192 4538306.81238404)")));

            //Debug.Assert(l0.Offset(+3.5, JoinStyle.Bevel).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.082823008 4538299.3188406, 421082.285891006 4538302.43534901, 421092.090123215 4538318.20161431, 421098.242035732 4538317.81602764, 421105.692734422 4538301.61885658, 421119.081646378 4538320.2717852, 421124.648402234 4538320.42927264, 421133.108345523 4538309.94904438, 421164.980467902 4538313.76280262)")));
            //Debug.Assert(l0.Offset(-3.5, JoinStyle.Bevel).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.941871558 4538292.37175232, 421084.804543738 4538295.6934806, 421087.347215396 4538297.31876844, 421094.600336457 4538308.98257122, 421101.847787405 4538293.22724308, 421107.87084894 4538292.64898413, 421122.088358079 4538312.45628318, 421128.877919328 4538304.04533417, 421132.017167242 4538302.76854091, 421165.81214192 4538306.81238404)")));

            //Debug.Assert(l0.Offset(+3.5, JoinStyle.Miter).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.082823008 4538299.3188406, 421082.285891006 4538302.43534901, 421092.090123215 4538318.20161431, 421095.524298066 4538323.72413524, 421098.242035732 4538317.81602764, 421105.692734422 4538301.61885658, 421119.081646378 4538320.2717852, 421121.761627604 4538324.00543833, 421124.648402234 4538320.42927264, 421133.108345523 4538309.94904438, 421164.980467902 4538313.76280262)")));
            //Debug.Assert(l0.Offset(-3.5, JoinStyle.Miter).IsEquivalent(GeometryFactory.FromWkt("LINESTRING(421057.941871558 4538292.37175232, 421084.804543738 4538295.6934806, 421086.464148486 4538295.89870433, 421087.347215396 4538297.31876844, 421094.600336457 4538308.98257122, 421101.847787405 4538293.22724308, 421104.362279244 4538287.76096901, 421107.87084894 4538292.64898413, 421122.088358079 4538312.45628318, 421128.877919328 4538304.04533417, 421130.094311945 4538302.53845189, 421132.017167242 4538302.76854091, 421165.81214192 4538306.81238404)")));

            //Debug.Assert(p1.Buffer(+1.0, JoinStyle.Miter).IsEquivalent(GeometryFactory.FromWkt("POLYGON((563770.056662568 4589693.76618792, 563768.233800431 4589718.09795466, 563768.159095163 4589719.09514868, 563769.156298366 4589719.1698677, 563781.621337308 4589720.10370987, 563781.554101109 4589721.00118683, 563764.601647235 4589719.73116141, 563763.604441892 4589719.65646682, 563763.529734198 4589720.65365935, 563761.281037369 4589750.66953843, 563761.20633073 4589751.6667466, 563762.203535304 4589751.74145147, 563782.945365417 4589753.29536523, 563783.942582649 4589753.37007627, 563784.017278454 4589752.37286729, 563784.215257871 4589749.73021393, 563784.763710774 4589749.77130807, 563805.206447837 4589751.30291656, 563805.180307745 4589751.65183769, 563805.10557282 4589752.64902205, 563806.102805681 4589752.72375073, 563813.781198026 4589753.29899213, 563814.778295412 4589753.3736725, 563814.853111062 4589752.37649419, 563814.879251104 4589752.02757373, 563815.826704974 4589752.09847221, 563815.901388724 4589751.10135107, 563817.604724962 4589728.36501157, 563817.679449793 4589727.36780878, 563816.682227027 4589727.29309853, 563795.990172012 4589725.74291376, 563796.016319468 4589725.39389433, 563796.091284379 4589724.39669703, 563795.093821534 4589724.32198129, 563790.157668859 4589723.95217999, 563792.219592634 4589696.42937038, 563792.294302645 4589695.43216314, 563791.297094699 4589695.35745734, 563771.053866493 4589693.84089729, 563770.056662568 4589693.76618792))")));
            //Debug.Assert(p1.Buffer(-1.0, JoinStyle.Miter).IsEquivalent(GeometryFactory.FromWkt("POLYGON((563771.901656877 4589695.91001582, 563770.302918954 4589717.25016427, 563782.767957896 4589718.18400644, 563783.765249263 4589718.25874065, 563783.690455831 4589719.25591948, 563783.47380453 4589722.14780742, 563783.3991851 4589723.14500965, 563782.401891493 4589723.07030536, 563765.449437619 4589721.80027994, 563763.350155892 4589749.82174804, 563782.097575033 4589751.2262467, 563782.713915338 4589742.99926126, 563782.788596241 4589742.00198179, 563783.785828376 4589742.07676332, 563785.331492133 4589742.19255967, 563786.328696557 4589742.26719516, 563786.253990067 4589743.26447271, 563785.910335932 4589747.85160995, 563806.353072995 4589749.38321844, 563807.350184555 4589749.45792444, 563807.275565989 4589750.45513111, 563807.249426267 4589750.8040473, 563812.933407642 4589751.2298736, 563812.959547363 4589750.88095742, 563813.034193385 4589749.88390538, 563813.981684715 4589749.95473833, 563815.535606439 4589729.21280196, 563794.843551423 4589727.66261719, 563793.846093886 4589727.58789005, 563793.921053488 4589726.59070415, 563793.947200944 4589726.24168472, 563789.01104827 4589725.87188342, 563788.013829988 4589725.79722833, 563788.088550336 4589724.79997038, 563790.150474111 4589697.27716077, 563771.901656877 4589695.91001582))")));

            //Debug.Assert(p1.Buffer(+1.5, JoinStyle.Miter).IsEquivalent(GeometryFactory.FromWkt("POLYGON((563762.166181529 4589752.24005421, 563782.908011642 4589753.79396797, 563784.403837689 4589753.9060296, 563784.515881197 4589752.41022107, 563784.676506436 4589750.26617582, 563784.726354528 4589750.26991062, 563804.670499142 4589751.76416362, 563804.569719682 4589753.11030214, 563806.065451906 4589753.22235347, 563813.743844251 4589753.79759487, 563815.23943752 4589753.9096444, 563815.340481445 4589752.56349065, 563816.287926107 4589752.63439684, 563816.399991468 4589751.13870485, 563818.103327705 4589728.40236535, 563818.215376058 4589726.9065602, 563816.719580803 4589726.79449579, 563796.526139848 4589725.28166564, 563796.627099326 4589723.93541357, 563795.13117531 4589723.82337855, 563790.693625378 4589723.49093103, 563792.718195377 4589696.46672416, 563792.830250438 4589694.97091909, 563791.334448474 4589694.8588546, 563771.091220268 4589693.34229455, 563769.595401854 4589693.23023609, 563767.735197688 4589718.06060088, 563767.63059846 4589719.4566799, 563764.639001011 4589719.23255867, 563763.1431954 4589719.12050939, 563763.031131454 4589720.61630557, 563760.782434626 4589750.63218465, 563760.670376878 4589752.12799212, 563762.166181529 4589752.24005421))")));
            //Debug.Assert(p1.Buffer(+3.0, JoinStyle.Miter) is IPolygon);

            //Debug.Assert(p1.Buffer(+3.0, JoinStyle.Miter).Buffer(+3.0, JoinStyle.Miter) is IPolygon);

            //Debug.Assert(p2.Buffer(13.0, JoinStyle.Miter) is IPolygon);
            //Debug.Assert(p2.Buffer(13.0, JoinStyle.Round) is IPolygon);

            //Debug.Assert(p2.Buffer(26.0, JoinStyle.Miter) is IPolygon);
            //Debug.Assert(p2.Buffer(26.0, JoinStyle.Round) is IPolygon);

            //Debug.Assert(p2.Buffer(52.0, JoinStyle.Miter) is IPolygon);
            //Debug.Assert(p2.Buffer(52.0, JoinStyle.Round) is IPolygon);

            //Debug.Assert(p2.Buffer(104.0, JoinStyle.Miter) is IPolygon);
            //Debug.Assert(p2.Buffer(104.0, JoinStyle.Round) is IPolygon);
        }

        void Poligonize()
        {
            var builder = GeometryFactory.Default.Create<IPolygonizer>();

            builder.Add(GeometryFactory.Read("LINESTRING(-47.6890749332019 3.36134371470256, -46.0084026346326 27.3109239693148, -17.2268895216337 28.1512601185994, -19.5378139321665 5.67226812523532, 6.5126066956573 5.88235216255648, 8.82353110619006 29.6218483798475)"));
            builder.Add(GeometryFactory.Read("LINESTRING(-17.2268895216337 28.1512601185994, 8.82353110619006 29.6218483798475, 9.03361514351121 46.8487394401826, -47.6890749332019 45.7983192535768, -46.0084026346326 27.3109239693148, -67.8571425160332 29.6218483798475, -68.4873946279967 5.67226812523532, -47.6890749332019 3.36134371470256, -19.5378139321665 5.67226812523532)"));
            
            //Debug.Assert(builder.GetPolygons().Count() == 4);
        }

        void ValidateIntersection(string wkt1, string wkt2, string intersectionWkt, double area)
        {
            var g1 = Geometry.Read(wkt1);
            var g2 = Geometry.Read(wkt2);
            var result = g1.Intersection(g2);
            var validation = Geometry.Read(intersectionWkt);

            Debug.Assert(result.GetArea().IsEquivalent(area));
            Debug.Assert(result.IsEquivalent(validation));
        }

        void ValidateUnion(string wkt1, string wkt2, string unionWkt, double area)
        {
            var g1 = Geometry.Read(wkt1);
            var g2 = Geometry.Read(wkt2);
            var result = g1.Union(g2);
            var validation = Geometry.Read(unionWkt);

            Debug.Assert(result.HasValue());
            Debug.Assert(result.GetArea().IsEquivalent(area));
            Debug.Assert(result.Coordinates.IsEquivalent(validation.Coordinates, ArrayComparison.Disorderly));
        }
    }
}